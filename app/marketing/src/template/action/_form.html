<form method="post">
    <div class="row">
        <div class="col-md-6">
            <!-- START: Title -->
            <div class="form-group{{#if errors.action_title}} has-error{{/if}}">
                <label>{{_ 'Title'}}</label>
                <div class="texts-field">
                    <input
                        class="form-control"
                        name="action_title"
                        placeholder="{{_ 'Enter Title'}}"
                        type="text"
                        value="{{item.action_title}}"
                    />
                </div>
                {{#if errors.action_title}}
                    <span class="help-text">{{errors.action_title}}</span>
                {{/if}}
            </div>
            <!-- END: Title -->
            <!-- START: Event -->
            <div class="form-group{{#if errors.action_event}} has-error{{/if}}">
                <label>{{_ 'Event'}}</label>
                <div class="select-field">
                    <select name="action_event" class="form-control">
                        {{#each events}}
                            <option
                                value="{{@key}}"
                                {{#when @key '==' ../item.action_event}}
                                    selected
                                {{/when}}
                            >
                                {{this}}
                            </option>
                        {{/each}}
                    </select>
                </div>
            </div>
            <!-- END: Event -->
            <!-- START: When -->
            <div
                class="form-group
                        {{#if errors.create_when}} has-error{{/if}}
                        {{#if errors.create_value}} has-error{{/if}}
                    "
                id="when-group"
            >
                <label>{{_ 'When'}}</label>
                <div id="when" class="when-wrapper">
                    {{#each item.action_when}}
                        <div class="input-range-when" data-id="{{@index}}">
                            <div class="input-from">
                                <select
                                    class="form-control condition-select"
                                    name="action_when[{{@index}}][field]"
                                >
                                    <option
                                        {{#when this.field '==' 'profile_name'}}
                                            selected
                                        {{/when}}
                                        value="profile_name"
                                    >
                                        {{_ 'Profile Name'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_email'}}
                                            selected
                                        {{/when}}
                                        value="profile_email"
                                    >
                                        {{_ 'Email'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_credits'}}
                                            selected
                                        {{/when}}
                                        value="profile_credits"
                                    >
                                        {{_ 'With Credits'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_detail'}}
                                            selected
                                        {{/when}}
                                        value="profile_detail"
                                    >
                                        {{_ 'Detail'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_company'}}
                                            selected
                                        {{/when}}
                                        value="profile_company"
                                    >
                                        {{_ 'Company'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_gender'}}
                                            selected
                                        {{/when}}
                                        value="profile_gender"
                                    >
                                        {{_ 'Gender'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_birth'}}
                                            selected
                                        {{/when}}
                                        value="profile_birth"
                                    >
                                        {{_ 'Birth Date'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_address_city'}}
                                            selected
                                        {{/when}}
                                        value="profile_address_city"
                                    >
                                        {{_ 'City'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_address_state'}}
                                            selected
                                        {{/when}}
                                        value="profile_address_state"
                                    >
                                        {{_ 'State/Region'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_address_country'}}
                                            selected
                                        {{/when}}
                                        value="profile_address_country"
                                    >
                                        {{_ 'Country'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_address_postal'}}
                                            selected
                                        {{/when}}
                                        value="profile_address_postal"
                                    >
                                        {{_ 'Postal'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_achievements'}}
                                            selected
                                        {{/when}}
                                        value="profile_achievements"
                                    >
                                        {{_ 'Achievements'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_experience'}}
                                            selected
                                        {{/when}}
                                        value="profile_experience"
                                    >
                                        {{_ 'Experience'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_type'}}
                                            selected
                                        {{/when}}
                                        value="profile_type"
                                    >
                                        {{_ 'Type of User'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_facebook'}}
                                            selected
                                        {{/when}}
                                        value="profile_facebook"
                                    >
                                        {{_ 'Facebook'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_verified'}}
                                            selected
                                        {{/when}}
                                        value="profile_verified"
                                    >
                                        {{_ 'Verified'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_package'}}
                                            selected
                                        {{/when}}
                                        value="profile_package"
                                    >
                                        {{_ 'Package'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_tags'}}
                                            selected
                                        {{/when}}
                                        value="profile_tags"
                                    >
                                        {{_ 'Tags'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_story'}}
                                            selected
                                        {{/when}}
                                        value="profile_story"
                                    >
                                        {{_ 'Story'}}
                                    </option>
                                    <option
                                        {{#when this.field '==' 'profile_subscribe'}}
                                            selected
                                        {{/when}}
                                        value="profile_subscribe"
                                    >
                                        {{_ 'Is Subscribed?'}}
                                    </option>
                                </select>
                            </div>
                            <span class="input-separator condition-operator">
                                <select 
                                    name="action_when[{{@index}}][operator]" 
                                    class="form-control"
                                >
                                    <option
                                        {{#when this.operator '==' '=='}}
                                            selected
                                        {{/when}}
                                        value="=="
                                    >
                                        ==
                                    </option>
                                    <option
                                        {{#when this.operator '==' '!='}}
                                            selected
                                        {{/when}}
                                        value="!="
                                    >
                                        !=
                                    </option>
                                    <option
                                        {{#when this.operator '==' 'LIKE'}}
                                            selected
                                        {{/when}}
                                        value="LIKE"
                                    >
                                        {{_ 'LIKE'}}
                                    </option>
                                    <option
                                        {{#when this.operator '==' '>'}}
                                            selected
                                        {{/when}}
                                        value=">"
                                    >
                                        >
                                    </option>
                                    <option
                                        {{#when this.operator '==' '>='}}
                                            selected
                                        {{/when}}
                                        value=">="
                                    >
                                        >=
                                    </option>
                                    <option
                                        {{#when this.operator '==' '<'}}
                                            selected
                                        {{/when}}
                                        value="<"
                                    >
                                        &#60;
                                    </option>
                                    <option
                                        {{#when this.operator '==' '<='}}
                                            selected
                                        {{/when}}
                                        value="<="
                                    >
                                        &#60;=
                                    </option>
                                    <option
                                        {{#when this.operator '==' 'HAS'}}
                                            selected
                                        {{/when}}
                                        value="HAS"
                                    >
                                        has
                                    </option>
                                </select>
                            </span>
                            <div class="input-to condition-value">
                                <input
                                    class="form-control"
                                    name="action_when[{{@index}}][value]"
                                    placeholder="{{_ '10000'}}"
                                    type="text"
                                    value={{this.value}}
                                />
                            </div>
                            <div class="remove">
                                <a
                                    class="text-danger remove-condition"
                                    href="javascript:void(0)"
                                >
                                    <i class="fa fa-times" aria-hidden="true"></i>
                                </a>
                            </div>
                        </div>
                    {{/each}}
                </div>

                <div class="form-group add-condition-button-only">
                    <button
                        class="btn btn-info"
                        data-do="add-condition"
                        data-on="click"
                        type="button"
                    >
                        <i class="fa fa-plus"></i> {{_ 'Add Condition'}}
                    </button>
                </div>

                {{#if errors.create_when}}
                    <span class="help-text">{{errors.create_when}}</span>
                {{/if}}
                {{#if errors.create_value}}
                    <span class="help-text">{{errors.create_value}}</span>
                {{/if}}
            </div>
            <!-- END: When -->
            <!-- START: Add tags -->
            <div class="form-group action-add-tag-field-only">
                <label>{{_ 'Add Tags'}}</label>
                <div
                    class="tag-field"
                    data-do="tag-field"
                    data-name="action_tags[add]"
                >
                    {{#each item.action_tags.add}}
                        <div class="tag">
                            <input
                                class="tag-input text-field"
                                name="action_tags[add][]"
                                placeholder="{{_ 'Tag'}}"
                                type="text"
                                value="{{this}}"
                            />
                            <a class="remove" href="javascript:void(0)">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    {{/each}}
                </div>
            </div>
            <!-- END: Add tags -->
            <!-- START: Remove tags -->
            <div class="form-group">
                <label>{{_ 'Remove Tags'}}</label>
                <div
                    class="tag-field"
                    data-do="tag-field"
                    data-name="action_tags[remove]"
                >
                    {{#each item.action_tags.remove}}
                        <div class="tag">
                            <input
                                class="tag-input text-field"
                                name="action_tags[remove][]"
                                placeholder="{{_ 'Tag'}}"
                                type="text"
                                value="{{this}}"
                            />
                            <a class="remove" href="javascript:void(0)">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    {{/each}}
                </div>
            </div>
            <!-- END: Remove tags -->
            <button class="btn btn-primary">{{_ 'Submit'}}</button>
        </div>
        <div class="col-md-6">
            <!-- START: Medium -->
            <div class="form-group{{#if errors.action_medium}} has-error{{/if}}">
                <label>{{_ 'Notifier Medium'}}</label>
                <div class="select-field">
                    <select
                        class="form-control"
                        data-do="pull-template"
                        data-on="change"
                        name="action_medium"
                    >
                        <option value="no-campaign">
                            {{_ 'No Sending Action'}}
                        </option>
                        <option
                            {{#when item.action_medium === 'email'}}
                                selected
                            {{/when}}
                            value="email"
                        >
                            {{_ 'Email'}}
                        </option>
                        <option
                            {{#when item.action_medium === 'sms'}}
                                selected
                            {{/when}}
                            value="sms"
                        >
                            {{_ 'SMS'}}
                        </option>
                    </select>
                </div>

                {{#if errors.action_medium}}
                    <span class="help-text">{{errors.action_medium}}</span>
                {{/if}}
            </div>
            <!-- END: Medium -->
            <!-- START: Notifier -->
            <div class="form-group">
                <label>{{_ 'Notifier Template'}}</label>
                <div class="select-field">
                    <select
                        class="form-control"
                        data-do="pull-template"
                        data-on="change"
                        name="template_id"
                    >
                        <option value="no-campaign">
                            {{_ 'No Sending Action'}}
                        </option>
                        {{#if templates.rows}}
                            {{#each templates.rows}}
                                <option
                                    value="{{template_id}}"
                                    {{#when template_id '==' ../item.template_id}}
                                        selected
                                    {{/when}}
                                >
                                    {{template_title}}
                                </option>
                            {{/each}}
                        {{/if}}
                    </select>
                </div>
            </div>
            <!-- END: Notifier -->
            <!-- START: Preview -->
            <div class="form-group">
                <label>{{_ 'Preview'}}</label>
                <div class="preview" id="preview" ></div>
                <div class="hide text-center" id="preview-loader">
                    <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
                </div>
            </div>
            <!-- END: Preview -->
        </div>
    </div>
</form>
<script id="condition-template" type="text/html">
    <div class="input-range-when" data-id="[i]">
        <div class="input-from">
            <select
                class="form-control condition-select"
                name="action_when[[i]][field]"
            >
                <option value="profile_name">{{_ 'Profile Name'}}</option>
                <option value="profile_email">{{_ 'Email'}}</option>
                <option value="profile_credits">{{_ 'With Credits'}}</option>
                <option value="profile_detail">{{_ 'Detail'}}</option>
                <option value="profile_company">{{_ 'Company'}}</option>
                <option value="profile_gender">{{_ 'Gender'}}</option>
                <option value="profile_birth">{{_ 'Birth Date'}}</option>
                <option value="profile_address_city">{{_ 'City'}}</option>
                <option value="profile_address_state">{{_ 'State/Region'}}</option>
                <option value="profile_address_country">{{_ 'Country'}}</option>
                <option value="profile_address_postal">{{_ 'Postal'}}</option>
                <option value="profile_achievements">{{_ 'Achievements'}}</option>
                <option value="profile_experience">{{_ 'Experience'}}</option>
                <option value="profile_type">{{_ 'Type of User'}}</option>
                <option value="profile_facebook">{{_ 'Facebook'}}</option>
                <option value="profile_verified">{{_ 'Verified'}}</option>
                <option value="profile_package">{{_ 'Package'}}</option>
                <option value="profile_tags">{{_ 'Tags'}}</option>
                <option value="profile_story">{{_ 'Story'}}</option>
                <option value="profile_subscribe">{{_ 'Is Subscribed?'}}</option>
            </select>
        </div>
        <span class="input-separator condition-operator">
            <select name="action_when[[i]][operator]" class="form-control">
                <option value="==">==</option>
                <option value="===">===</option>
                <option value="!=">!=</option>
                <option value="!==">!==</option>
                <option value="LIKE">{{_ 'LIKE'}}</option>
                <option value=">">></option>
                <option value=">=">>=</option>
                <option value="<">&#60;</option>
                <option value="<=">&#60;=</option>
                <option value="HAS">has</option>
            </select>
        </span>
        <div class="input-to condition-value">
            <input
                class="form-control"
                name="action_when[[i]][value]"
                placeholder="{{_ '10000'}}"
                type="text"
            />
        </div>
        <div class="remove">
            <a
                class="text-danger remove-condition"
                href="javascript:void(0)"
            >
                <i aria-hidden="true" class="fa fa-times"></i>
            </a>
        </div>
    </div>
</script>
